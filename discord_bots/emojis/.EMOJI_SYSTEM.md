# Dynamic Emoji Management System

This project has been upgraded to use a dynamic emoji management system that automatically handles Discord application emojis with full TypeScript support for code completion and type safety.

## How It Works

### 1. Emoji Files

- All emojis are stored as image files in the `emojis/` folder
- The filename (without extension) becomes the emoji name
- Supported formats: `.png`, `.jpg`, `.jpeg`, `.gif`, `.webp`

### 2. TypeScript Type Generation

- TypeScript types are automatically generated from emoji filenames
- This provides full code completion and type checking for `Emoji.{emoji_name}`
- Types are regenerated whenever emojis are synced or manually via `npm run generate-emoji-types`

### 3. Automatic Sync

- When deploying commands, emojis are automatically synced with Discord
- Missing emojis are uploaded to the application
- Unused emojis are removed from the application
- TypeScript types are automatically regenerated after sync
- This ensures your bot always has the right emojis available

### 4. Usage in Code

#### New Way (Recommended with Type Safety)

```javascript
// In any function that has access to the client
const emojiString = client.applicationEmojis.green_left_full;
```

#### Old Way (Still Supported with Types)

```javascript
// Still works for backwards compatibility, now with full type completion!
const { Emoji } = require("@constants");
const emojiString = Emoji.green_left_full; // ✅ Full autocomplete and type checking
// const invalidEmoji = Emoji.typo_name; // ❌ TypeScript error for invalid names
```

### 5. Adding New Emojis

1. Add the emoji image file to the `emojis/` folder
2. Name the file with the desired emoji name (e.g., `my_new_emoji.png`)
3. Deploy commands: `npm run dev:5th` (or run `node scripts/emoji-sync.js 5th`)
4. The emoji will be automatically uploaded and available as `client.applicationEmojis.my_new_emoji`
5. TypeScript types will be automatically updated

### 6. Scripts

#### Deploy Commands + Sync Emojis + Generate Types

```bash
npm run dev:5th      # Generates types, deploys commands, and syncs emojis for 5th edition bot
npm run dev:20th     # Generates types, deploys commands, and syncs emojis for 20th edition bot
npm run dev:cod      # Generates types, deploys commands, and syncs emojis for CoD bot
```

#### Manual Emoji Sync Only

```bash
node scripts/emoji-sync.js 5th   # Sync emojis for 5th edition bot (auto-generates types)
node scripts/emoji-sync.js 20th  # Sync emojis for 20th edition bot (auto-generates types)
node scripts/emoji-sync.js cod   # Sync emojis for CoD bot (auto-generates types)
```

#### Manual Type Generation

```bash
npm run generate-emoji-types  # Generate TypeScript types from emoji files
```

#### Create Placeholder Files

```bash
node scripts/create-emoji-placeholders.js  # Creates placeholder files for missing emojis
```

## Type Safety Benefits

### ✅ Code Completion

- Full autocomplete for all emoji names when using `Emoji.{name}`
- Works in VS Code and other TypeScript-aware editors

### ✅ Type Checking

- Compile-time errors for typos in emoji names
- Prevents runtime errors from missing emojis

### ✅ Refactoring Support

- Safe renaming of emoji files with automatic type updates
- Find all usages of specific emojis across your codebase

## Migration Notes

### For Developers

- New code should use `Emoji.emojiName` for full type safety
- Use `client.applicationEmojis.emojiName` when you have direct client access

### Benefits

- ✅ No more hardcoded emoji IDs
- ✅ Works with any Discord application automatically
- ✅ Easy to add/remove emojis
- ✅ Automatic cleanup of unused emojis
- ✅ Backwards compatible with existing code
- ✅ No need to manually manage different bot configurations
- ✅ **Full TypeScript support with code completion and type checking**
- ✅ **Prevents typos and runtime errors**

### Environment Variables

Make sure these are set for each bot:

- `CLIENT_ID_5TH` and `TOKEN_5TH` for 5th edition bot
- `CLIENT_ID_20TH` and `TOKEN_20TH` for 20th edition bot
- `CLIENT_ID_COD` and `TOKEN_COD` for Chronicles of Darkness bot

## Troubleshooting

### Emoji not showing up?

1. Check if the emoji file exists in the `emojis/` folder
2. Run the emoji sync script: `node scripts/emoji-sync.js <version>`
3. Check the console for any error messages

### Types not updating?

1. Run `npm run generate-emoji-types` manually
2. Restart your TypeScript language server in VS Code
3. Check that `jsconfig.json` and `tsconfig.json` are properly configured

### Rate limits?

The emoji management script includes delays to avoid Discord rate limits. If you hit limits, wait a few minutes and try again.

### Emoji file naming?

- Use only letters, numbers, and underscores
- No spaces or special characters
- Case sensitive (use lowercase for consistency)
- Supported extensions: `.png`, `.jpg`, `.jpeg`, `.gif`, `.webp`
